<!doctype html>
<html lang="de">
<link rel="icon" href="images/favicon.ico" />
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="cache-control" content="max-age=0">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 11:00:00 GMT">
    <meta http-equiv="pragma" content="no-cache">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="fonts/icomoon/style.css">

    <link rel="stylesheet" href="css/owl.carousel.min.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    
    <!-- Style -->
    <link rel="stylesheet" href="css/style.css">

    <title>Kalender</title>
    <style>
      .day {
        width: 10%;
        height: 80px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.07);
        padding: 27px;
        margin-top: 10px;
        display: inline-block;
        margin-left: 3px;
        margin-right: 3px;
      }

      .week {
        width: 100%;
        height: 100px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.04);
        border-radius: 10px;
        margin-left: -5px;
        margin-bottom: 20px;
      }

      .dayBlock {
        width: 10%;
        height: 30px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.05);
        padding: 27px;
        margin-top: -20px;
        display: inline-block;
        margin-left: 1.3px;
        margin-right: 1.3px;
      }

      .dayName {
        position: absolute;
        margin-top: -24px;
        font-size: 30px;
        margin-left: -13px;
        font-weight: 600;
      }

      .weekBlock {
        width: 100%;
        height: 30px;
        margin-left: -5px;
        margin-bottom: 20px;
      }

      .monthBlock {
        width: 100%;
        height: 30px;
        margin-left: -5px;
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
      }

      .monthName {
        position: absolute;
        font-size: 43px;
        font-weight: 600;
        margin-top: -45px;
        width: auto;
      }

      .dayNameS {
        margin-left: -10px;
      }

      .dTitle {
        position: absolute;
        margin-left: 35px;
        margin-top: -33px;
        opacity: 0;
        visibility: hidden;
        text-align: center;
        border-radius: 5px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.08);
        background-color: white;
        width: auto;

      }

      .eventOn {
        background:linear-gradient(0deg, #38d39f -2%, rgba(255,255,255,1) 20%);
      }

      .today {
        outline: 3px solid #58e6b7;
      }

      .date {
        position: absolute;
        margin-top: -24px;
        margin-left: -8px;
        font-size: 30px;
        font-weight: 600;
      }

      .L {
        margin-left: -18px;
      }

      .time {
        opacity: 0;
        position: absolute;
        margin-top: 10px;
        margin-left: -19px;
        font-size: 15px;
        font-weight: 600;
      }

      .dDesc {
        display: inline-block;
        width: 190px;

      }

      .changeIcon {
        height: 35px;
      }
    </style>
  </head>
  <body>

    <script>
      allowTheme = true
      if (allowTheme == true) {
        if (localStorage.getItem("theme") == "dark-mode") {
          const addCSS = css => document.head.appendChild(document.createElement("style")).innerHTML = css;

          addCSS(`html:not(#ente){filter: invert(1) hue-rotate(180deg);}#ente{filter: invert(1) hue-rotate(180deg);}`)
        } else {
        }
      }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

    <div id="mainbar"
         style="line-height: 53px; height:60px; width: 95%; background-color: rgb(255, 255, 255); margin: auto; margin-top: 15px; border-radius: 10px; box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.1);">
      <a href="https://www.gruleiru.de/main.html"><img src="images/ente.png" style="height:50px; margin-left: 10px;" class="ente" id="ente"></a>
      <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 10px;"><a
              style="color: black;" id="reminder" href="https://www.google.com">Termine</a></span>
      <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="pictures" href="https://gruleiru.de">Fotoalbum</a></span>-->
      <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="settings" href="https://www.google.com">Einstellungen</a></span>-->
      <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
              style="color: black;" id="invites" href="https://www.google.com">Einladungen</a></span>
      <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
              style="color: black;" id="hefa" href="https://www.google.com">HeFa</a></span>
      <div id="drop" class="drop"
           style="height: 60px; width: 70px; border-radius: 10px; background-color: rgb(255, 255, 255); box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.1); float: right;">
        <a id="more"><img src="images/more.png"
                          style="height: 30px; float: right; margin-top: 13px; margin-right: 20px;"></a>
        <a href="https://www.google.com" id="settings"><img src="images/set.png"
                                                            style="height: 30px; float: right; margin-top: 20px; margin-right: 20px;"></a>
        <a onclick="Logout('temp')" id="logout" class="logout"><img src="images/logout.png"
                                                                    style="height: 30px; float: right; margin-top: 20px; margin-right: 19px;"></a>
      </div>

    </div>
    <script>
      ext = "160"
      function mobile() {
        var userAgent = navigator.userAgent;
        if (userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i)) {
          return true;
        } else {
          return false;
        }
      }
      if (mobile() == true) {
        ext = "205"
        document.getElementById("mainbar").innerHTML = `
      <a href="https://www.gruleiru.de/main.html"><img src="images/ente.png" style="height:50px; margin-left: 10px;" class="ente" id="ente"></a>
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 10px;"><a
        style="color: black;" id="reminder" href="https://www.google.com">Termine</a></span>
    <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="pictures" href="https://gruleiru.de">Fotoalbum</a></span>-->
    <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="settings" href="https://www.google.com">Einstellungen</a></span>-->
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
        style="color: black;" id="hefa" href="https://www.google.com">HeFa</a></span>
    <a href="https://www.dropbox.com/scl/fo/ka6jnvb837dyuwkdi0w1s/h?dl=0&rlkey=giihr4pwablkueo3dodj2ry9u" id="dropbox" class="dropbox"><img src="images/dropbox.png"
          style="height: 30px; margin-left: 19px;"></a>
    <div id="drop" class="drop"
      style="height: 60px; width: 70px; border-radius: 10px; background-color: rgb(255, 255, 255); box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.1); float: right;">
      <a id="more"><img src="images/more.png"
          style="height: 30px; float: right; margin-top: 13px; margin-right: 20px;"></a>
      <a href="https://www.google.com" id="settings"><img src="images/set.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 20px;"></a>
      <a href="https://www.google.com" id="invites" class="logout"><img src="images/invitation.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 20px;"></a>
      <a onclick="Logout('temp')" id="logout" class="logout"><img src="images/logout.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 19px;"></a>

      `
      } else {
        ext = "160"
        document.getElementById("mainbar").innerHTML = `<a href="https://www.gruleiru.de/main.html"><img src="images/ente.png" style="height:50px; margin-left: 10px;" class="ente" id="ente"></a>
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 10px;"><a
        style="color: black;" id="reminder" href="https://www.google.com">Termine</a></span>
    <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="pictures" href="https://gruleiru.de">Fotoalbum</a></span>-->
    <!--span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a style="color: black;" id="settings" href="https://www.google.com">Einstellungen</a></span>-->
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
        style="color: black;" id="invites" href="https://www.google.com">Einladungen</a></span>
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
        style="color: black;" id="hefa" href="https://www.google.com">HeFa</a></span>
    <span style="line-height: normal; display: inline-block; vertical-align: middle; margin-left: 20px;"><a
        style="color: black;" id="db" href="https://www.dropbox.com/scl/fo/ka6jnvb837dyuwkdi0w1s/h?dl=0&rlkey=giihr4pwablkueo3dodj2ry9u">Dropbox</a></span>
    <div id="drop" class="drop"
      style="height: 60px; width: 70px; border-radius: 10px; background-color: rgb(255, 255, 255); box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.1); float: right;">
      <a id="more"><img src="images/more.png"
          style="height: 30px; float: right; margin-top: 13px; margin-right: 20px;"></a>
      <a href="https://www.google.com" id="settings"><img src="images/set.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 20px;"></a>
      <a onclick="Logout('temp');" id="logout" class="logout"><img src="images/logout.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 19px;"></a>
      <a href="https://www.gruleiru.de/cookies" id="logout" class="logout"><img src="images/kekse.png"
          style="height: 30px; float: right; margin-top: 20px; margin-right: 19px;"></a>`
      }
      animating = false
      animatingout = false
      $(".drop").animate({
        height: '60'
      })
      $('.drop').hover(function () {
        if (animatingout == true) {
          animating = true
          $(this).stop()
          $(this).animate({
            height: ext
          }, function () {
            animatingout = false
            animating = true
          })
        }


        if (animating == false) {
          animating = true
          $(this).animate({
            height: ext
          }, function () {
            animating = false
          })
        }
      })
      $('.drop').mouseleave(function () {
        animatingout = true
        $(this).stop()
        $(this).animate({
          height: '60'
        }, function () {
          animatingout = false
          animating = false
        })
      })
    </script>

    <script>
      const Http = new XMLHttpRequest();
      const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);
      const session = urlParams.get('sid')
      const domain = "https://www.gruleiru.de"

      document.getElementById("reminder").setAttribute("href", domain + "/panel?sid=" + session)
      document.getElementById("settings").setAttribute("href", domain + "/settings?sid=" + session)
      document.getElementById("invites").setAttribute("href", domain + "/invites?sid=" + session)
      document.getElementById("hefa").setAttribute("href", domain + "/hefa?sid=" + session)
      // document.getElementById("logout").setAttribute("href", "https://regapi.gruleiru.de/logout?sid=" + session)
      document.getElementById("logout").setAttribute("onclick", "Logout('" + session + "');")

      function Logout (session) {
        const loutUrl = 'https://regapi.gruleiru.de/logout?session=' + session;
        Http.open("GET", loutUrl);
        Http.send();
        Http.onload = (e) => {
          window.location.href = "https://www.gruleiru.de"
        }
      }
    </script>

    <div class="content">
      <div class="container">
        <div class="row justify-content-center">
          <!-- <div class="col-md-6 order-md-2">
            <img src="images/undraw_file_sync_ot38.svg" alt="Image" class="img-fluid">
          </div> -->
          <div class="col-md-6 contents">
            <div class="row justify-content-center">
              <div class="col-md-12">
                <div class="form-block" id="block">
                  <img src="images/rows.png" class="changeIcon" onclick="window.location.href = 'panel?sid=' + session">
                  <div class="monthBlock">
                    <span class="monthName" id="monthName">August</span>
                  </div>
                  <div class="weekBlock">
                    <div class="dayBlock"><span class="dayName">M</span></div>
                    <div class="dayBlock"><span class="dayName dayNameS">D</span></div>
                    <div class="dayBlock"><span class="dayName">M</span></div>
                    <div class="dayBlock"><span class="dayName dayNameS">D</span></div>
                    <div class="dayBlock"><span class="dayName dayNameS">F</span></div>
                    <div class="dayBlock"><span class="dayName dayNameS">S</span></div>
                    <div class="dayBlock"><span class="dayName dayNameS">S</span></div>
                  </div>
                  <div id="cal">

                  </div>
<!--                  <div class="week">-->

<!--                    <div class="day">-->
<!--                      <span class="date">1</span>-->
<!--                      <span class="dTitle">Test</span>-->
<!--                    </div>-->

<!--                  </div>-->
                </div>



                <script>
                  ///////////////////////////////////////////Add days to calender///////////////////////////////////////////
                  var currentDate = new Date();
                  var currentMonth = currentDate.getMonth();
                  currentMonth = currentMonth + 1;
                  var daysInMonth = new Date(currentDate.getFullYear(), currentMonth, 0).getDate();

                  calender = document.getElementById("cal");

                  dCount = 0
                  cWeek = document.createElement("div")
                  cWeek.className = "week"
                  calender.appendChild(cWeek);

                  for (var day = 1; day <= daysInMonth; day++) {
                    dCount += 1
                    if(dCount == 8) {
                      dCount = 1
                      cWeek = document.createElement("div")
                      cWeek.className = "week"
                      calender.appendChild(cWeek);
                    }
                    if(day.toString().length == 1) {
                      cWeek.innerHTML += "<div class='day'><span class='date'>" + day + "</span></div>"
                    }
                    else {
                      cWeek.innerHTML += "<div class='day'><span class='date L'>" + day + "</span></div>"
                    }

                  }
                    ///////////////////////////////////////////Change Month name///////////////////////////////////////////
                  const monthName = currentDate.toLocaleString('default', { month: 'long' });

                  document.getElementById("monthName").innerHTML = monthName;
                </script>


                <script>
                  function shortenText(text) { //shorten text
                    if (text.length > 40) {
                      return text.substring(0, 40) + "...";
                    }
                    return text;
                  }
                    ///////////////////////////////////////////Add events to calender///////////////////////////////////////////
                  const url = 'https://regapi.gruleiru.de/reminder?session=' + session;
                  Http.open("GET", url);
                  Http.send();
                  Http.onload = (e) => {
                    response = JSON.parse(Http.responseText);
                    if (response["error"] == "0x1") {
                      paused = true
                      document.getElementById("block").innerHTML = `<div class="mb-4"><h3>Gruleiru <strong class="nwtxt">Termine</strong></h3>`
                      document.getElementById("block").innerHTML += `<img src="images/search.png" style="height: 40px"><br><span class="nwtxt">Die Session wurde nicht gefunden. Bitte melde dich erneut an!</span>`
                    } else {
                      if (response["dates"].length == 0) {
                          document.getElementById("block").innerHTML = `<div class="mb-4"><h3>Gruleiru <strong class="nwtxt">Termine</strong></h3>`

                          if (Math.floor(Math.random() * 20) == 1) {
                            document.getElementById("block").innerHTML += `<img src="images/loading.gif" style="height:45px;"><br><span class="nwtxt">Du hast die Ente getroffen *KWAK*</span>`
                          } else {
                            document.getElementById("block").innerHTML += `<img class="nwtxt" src="images/search.png" style="height: 40px"><br><span class="nwtxt">Wir haben leider keine Termine in der Datenbank finden können</span>`
                          }

                      }
                    }
                    const currentDate = new Date();
                    const currentYear = currentDate.getFullYear();
                    const currentMonth = currentDate.getMonth();
                    const currentDay = currentDate.getDate();

                    const divElements = document.querySelectorAll('div.day');
                    divElements.forEach((divElement) => {
                      const spanElement = divElement.querySelector('span');
                      if (spanElement && spanElement.textContent == currentDay) {
                        divElement.classList.add("today");
                      }
                    });

                    for (let i = 0; i < response["dates"].length; i++) {
                      date = new Date(response["dates"][i]["date"]);

                      dateYear = date.getFullYear();
                      dateMonth = date.getMonth();
                      dateDay = date.getDate();
                      if (currentYear === dateYear && currentMonth === dateMonth) {

                        const divElements = document.querySelectorAll('div.day');
                        divElements.forEach((divElement) => {
                          const spanElement = divElement.querySelector('span');
                          if (spanElement && spanElement.textContent == dateDay) {
                            divElement.innerHTML += "<span class='dTitle'>" + response["dates"][i]["title"] + "<br><span class='dDesc' style='display: none'>" + shortenText(response["dates"][i]["description"]) + "</span></span>"
                          }
                        });

                      }
                    }
                    ////////////////////////////////////////Reset
                    MouseOver = false
                    MouseOverObj = null
                    function dTitleWidth() { //add 25px to width of dTitle
                      var divs = document.getElementsByClassName("dTitle");

                      for (var i = 0; i < divs.length; i++) {
                        var div = divs[i];
                        var originalWidth = div.offsetWidth;

                        div.style.width = (originalWidth + 25) + "px";
                      }
                    }
                    dTitleWidth()
                    ////////////////////////////////////////


                    $(".week .day:has(.dTitle)").addClass("eventOn"); //add mark to day with event

                    $(".day").hover(function () { //hover effect
                      $(this).css({"box-shadow": "0px 0px 15px rgba(0, 0, 0, 0.2)"});
                    }, function () {
                      $(this).css({"box-shadow": "0px 0px 10px rgba(0, 0, 0, 0.05)"});
                    });

                    $(".day:has(.dTitle)").hover(function () {
                      ////////////////////////////////////////////Reset
                      $(".dTitle").css({"height": "auto"});
                      $(".dTitle").css({"width": "auto"});
                      $(".dTitle").css({"margin-top": "-33px"});
                      $(".time").css({"margin-top": "10px"});
                      dTitleWidth()
                      $(this).children(".dTitle").css({
                        borderTopLeftRadius: 5,
                        borderTopRightRadius: 5,
                        borderBottomLeftRadius: 5,
                        borderBottomRightRadius: 5 })
                      ////////////////////////////////////////////
                      MouseOver = true
                      MouseOverObj = this
                      $(this).animate({height:'100px'}, "fast");
                      $(this).children(".dTitle").animate({opacity: '1'}, 350);
                      $(this).children(".time").animate({opacity: '1'}, { duration: 200, queue: false });
                      $(this).children(".time").animate({marginTop: '25px'}, { duration: 200, queue: false });

                      ts = this
                      setTimeout(function () {
                        $(ts).children(".dTitle").css({"visibility": "visible"});
                      }, 100);
                      $(ts).children(".dTitle").children(".dDesc").css({"display": "none"});
                      setTimeout(function () {
                        if(MouseOver == true && MouseOverObj == ts) {
                          $(ts).children(".dTitle").animate({height: '90px'}, { duration: 350, queue: false });
                          $(ts).children(".dTitle").animate({marginTop: '-100px'}, { duration: 350, queue: false });
                          $(ts).children(".dTitle").animate({width: '200px'}, { duration: 350, queue: false });
                          $(ts).children(".dTitle").children(".dDesc").css({"display": "inline-block"});
                          $(ts).children(".dTitle").animate({
                            borderTopLeftRadius: 10,
                            borderTopRightRadius: 10,
                            borderBottomLeftRadius: 10,
                            borderBottomRightRadius: 10}, 350);
                        }
                      }, 1000);


                    }, function () {
                      MouseOver = false
                      $(this).animate({height: '80px'}, "fast");
                      $(this).children(".dTitle").animate({opacity: '0'}, 100);
                      $(this).children(".time").animate({opacity: '0'}, 100);
                      setTimeout(function () {
                        $(".dTitle").css({"visibility": "hidden"});
                        $(".dTitle").css({"height": "auto"});
                        $(".dTitle").css({"width": "auto"});
                        $(".dTitle").css({"margin-top": "-33px"});
                        $(".time").css({"margin-top": "15px"});
                        $(".time").css({"opacity": "0"});
                        dTitleWidth()
                        $(ts).children(".dTitle").children(".dDesc").css({"display": "none"});

                      }, 100);
                      ////////////////////////////////////////////Reset

                      setTimeout(function () {
                        $(".time").css({"opacity": "0"});
                        $(".time").css({"margin-top": "10px"});
                      }, 201);
                      ////////////////////////////////////////////
                    });
                  }








                </script>
              </div>
            </div>

          </div>

        </div>
      </div>
    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

  </body>
</html>